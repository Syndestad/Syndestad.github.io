---
title: Test for trend in proportions
author: Synn√∏ve Yndestad
date: '2021-08-09'
slug: []
categories: ["R", "Statistics", "Clinical science"]
tags: ["prop.trend.test", "Chi-square","Categoricals","Crosstab", "Non-parametric", "epitools"]
subtitle: ''
excerpt: ''
series: ~
layout: single
---




The test for trends in proportions is also known as the Cochran Armitage test. It performs Chi-squared test for trend in proportions and is used to test whether there is a difference between groups considering the size of the groups. It takes count data from contingency tables where you have one nominal variable with two levels (i.e "Mutated", "Wild-type") and the other variable is an ordinal value with minimum 3 values where the variables is naturally ranked (i.e "Low-exposure" < "Medium-exposure" < "High-exposure"). The null hypothesis is that there is no trend.







Using data listed in [table two](https://doi.org/10.1016/j.annonc.2020.11.009) we will test if there is a trend over response in patients with breast cancer treated with Olaparib if the tumor has a mutation in a [HR gene](https://en.wikipedia.org/wiki/Homologous_recombination).  
Response is our ordinal value where "CR+PR" represent a tumor shrinkage of 30-100% (Complete or Partial Response), "SD" (Stable disease) represent a shrinkage of less than 30% to 20% increace, while "PD" (Progressive disease) is an increace of more than 20%. Mutational status is our nominal value with the values HR-mutated or Wild-type


First, create a contingency table from vectors.

```{r}
Wt <- c(8, 10, 3)
HR_mutation <- c(10, 1, 0) 
df = rbind(HR_mutation, Wt)             # Bind vector by rows to a data frame
colnames(df) <- c("CR+PR", "SD", "PD")  # Add response values as column names
df                                      # print data frame
```


Count all cases in the table as a sanity check, and summarize the column values with `colSums()` and save the count as n.
```{r}
sum(df)               # Total count
n= colSums(df)        # Count by group/response. Sum column values.
n
```



Run the test with the base R function:  

prop.trend.test(x, n, score = seq_along(x))  
  
With the arguments:  
x = Number of events.   Count data, the HR_mutation or Wt vector.
n	= Number of trials.   The total number of participants pr ordinal level in trial, the colSum.
score	= Group score.    The level and order of the ordinal value. Default value is c(1,2,3, ..etc).  
`Seq_along(x)` as score will assign score = 1, 2, 3 etc to end of vector. Using this function we assume that the data is entered in an ordered fashion from small to large.


```{r}
prop.trend.test(HR_mutation, n, score = seq_along(HR_mutation))       

```

Either vector from the table will provide the same result, since their proportion will be the same:
```{r}
prop.trend.test(Wt, n, score = seq_along(Wt))
```

As we can see, the p value is smaller than 0.05, and we can conclude that there is a trend in the proportions of HR-mutated tumors over response.



If you want an online calculator solution, epitools has an excellent online calculator [here](https://epitools.ausvet.com.au/trend):  
https://epitools.ausvet.com.au/trend

A Sample-output of epitools online calculator of the example above are provided below: 

![epitools online calculator output](images/Epitools-Chi-squared-test-for-trend.jpeg)

